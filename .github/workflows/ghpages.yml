name: Publish Documentation

on:
  push:
    branches:
    - master
    - docpush

jobs:
  build:

    runs-on: windows-latest

    steps:        
      
    - name: Debugging
      run: echo Hello world ${{ env.FIRST_NAME }} $middle_name $Last_Name!
      env:
        FIRST_NAME: Mona
        middle_name: The
        Last_Name: Octocat
        
    - name: Clone NmeaParser
      uses: actions/checkout@v1
        
# REPO: https://github.com/%GITHUB_REPOSITORY%, SHA: %GITHUB_SHA% Branch: %BRANCH%
#    - name: Install .NET OMD Generator
#      run: dotnet tool install --tool-path artifacts/toolset dotMorten.OmdGenerator --version 1.2.0
#    - name: restore nuget packages
#      run: dotnet msbuild /t:restore src/NmeaParser/NmeaParser.csproj
#    - name: Generate OMD
#      run: |
#        mkdir artifacts/docs/api
#        artifacts/toolset/generateomd /source=src/NmeaParser /output=artifacts/docs/api/omd.html
    - name: Build Documentation
      run: build\GenerateDoc.cmd
#      uses: nikeee/docfx-action@master
#      with:
#        args: docs/docfx.json
      
    - name: Publish Documentation
      env:
        ACCESS_TOKEN: ${{ secrets.GH_PAT }}
        BRANCH: gh-branch
      run: |
        echo on
        git worktree add --checkout gh-action-temp-deployment-folder origin/$BRANCH
        ROBOCOPY artifacts/docs_site gh-action-temp-deployment-folder /MIR /XF .git
        git --work-tree=gh-action-temp-deployment-folder stage -A
        git --work-tree=gh-action-temp-deployment-folder commit -M "msg here"
#        git --work-tree=gh-action-temp-deployment-folder push 

#    - name: Publish Documentation
#      uses: maxheld83/ghpages@master
#      env:
#        BUILD_DIR: artifacts/docs_site
#        GH_PAT: ${{ secrets.GH_PAT }}
#      uses: JamesIves/github-pages-deploy-action@releases/v3
#      with:
#        ACCESS_TOKEN: ${{ secrets.GH_PAT }}
#        BRANCH: gh-pages # The branch the action should deploy to.
#        FOLDER: artifacts/docs_site # The folder the action should deploy.
